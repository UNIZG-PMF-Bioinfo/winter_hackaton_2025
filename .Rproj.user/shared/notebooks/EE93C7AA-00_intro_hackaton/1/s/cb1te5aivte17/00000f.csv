"0","glm_full_model <- glm(Stage ~ ., "
"0","                  data = trainData, "
"0","                  family = binomial)"
"0","# summary the model"
"0","summary(glm_full_model)"
"1","
Call:
"
"1",""
"1","glm(formula = Stage ~ ., family = binomial, data = trainData)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                                   "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","  "
"1","
(Intercept)                        "
"1","  6.1620744"
"1","  8.8086892"
"1","   0.700"
"1","   0.4842"
"1","  "
"1","
Age                                "
"1"," -0.0137400"
"1","  0.0111790"
"1","  -1.229"
"1","   0.2190"
"1","  "
"1","
GenderMale                         "
"1","  0.0406129"
"1","  0.3091391"
"1","   0.131"
"1","   0.8955"
"1","  "
"1","
Smoking_HistoryFormer Smoker       "
"1"," -0.4686336"
"1","  0.3705560"
"1","  -1.265"
"1","   0.2060"
"1","  "
"1","
Smoking_HistoryNever Smoked        "
"1"," -0.4672842"
"1","  0.3844983"
"1","  -1.215"
"1","   0.2242"
"1","  "
"1","
Tumor_Size_mm                      "
"1"," -0.0035486"
"1","  0.0058747"
"1","  -0.604"
"1","   0.5458"
"1","  "
"1","
Tumor_LocationMiddle Lobe          "
"1"," -0.3201917"
"1","  0.3711271"
"1","  -0.863"
"1","   0.3883"
"1","  "
"1","
Tumor_LocationUpper Lobe           "
"1"," -0.0684476"
"1","  0.3880006"
"1","  -0.176"
"1","   0.8600"
"1","  "
"1","
TreatmentRadiation Therapy         "
"1"," -0.5712611"
"1","  0.4260967"
"1","  -1.341"
"1","   0.1800"
"1","  "
"1","
TreatmentSurgery                   "
"1"," -0.5135948"
"1","  0.4325305"
"1","  -1.187"
"1","   0.2351"
"1","  "
"1","
TreatmentTargeted Therapy          "
"1"," -0.0420780"
"1","  0.4305020"
"1","  -0.098"
"1","   0.9221"
"1","  "
"1","
Survival_Months                    "
"1","  0.0005017"
"1","  0.0049215"
"1","   0.102"
"1","   0.9188"
"1","  "
"1","
EthnicityAsian                     "
"1"," -0.2593573"
"1","  0.4981284"
"1","  -0.521"
"1","   0.6026"
"1","  "
"1","
EthnicityCaucasian                 "
"1"," -0.2418126"
"1","  0.5089704"
"1","  -0.475"
"1","   0.6347"
"1","  "
"1","
EthnicityHispanic                  "
"1"," -0.2950323"
"1","  0.4911575"
"1","  -0.601"
"1","   0.5480"
"1","  "
"1","
EthnicityOther                     "
"1"," -1.0410848"
"1","  0.5099735"
"1","  -2.041"
"1","   0.0412"
"1"," *"
"1","
Insurance_TypeMedicare             "
"1"," -0.4086393"
"1","  0.4203341"
"1","  -0.972"
"1","   0.3310"
"1","  "
"1","
Insurance_TypeOther                "
"1"," -0.0033945"
"1","  0.4588297"
"1","  -0.007"
"1","   0.9941"
"1","  "
"1","
Insurance_TypePrivate              "
"1"," -0.2777777"
"1","  0.4530382"
"1","  -0.613"
"1","   0.5398"
"1","  "
"1","
Family_HistoryYes                  "
"1"," -0.7152512"
"1","  0.3114903"
"1","  -2.296"
"1","   0.0217"
"1"," *"
"1","
Comorbidity_DiabetesYes            "
"1"," -0.0892514"
"1","  0.3248315"
"1","  -0.275"
"1","   0.7835"
"1","  "
"1","
Comorbidity_HypertensionYes        "
"1","  0.5734431"
"1","  0.3193685"
"1","   1.796"
"1","   0.0726"
"1"," ."
"1","
Comorbidity_Heart_DiseaseYes       "
"1"," -0.1046268"
"1","  0.3260703"
"1","  -0.321"
"1","   0.7483"
"1","  "
"1","
Comorbidity_Chronic_Lung_DiseaseYes"
"1"," -0.2207061"
"1","  0.3179751"
"1","  -0.694"
"1","   0.4876"
"1","  "
"1","
Comorbidity_Kidney_DiseaseYes      "
"1"," -0.0642749"
"1","  0.3056653"
"1","  -0.210"
"1","   0.8335"
"1","  "
"1","
Comorbidity_Autoimmune_DiseaseYes  "
"1","  0.5063772"
"1","  0.3112034"
"1","   1.627"
"1","   0.1037"
"1","  "
"1","
Comorbidity_OtherYes               "
"1"," -0.0774512"
"1","  0.3230169"
"1","  -0.240"
"1","   0.8105"
"1","  "
"1","
Performance_Status                 "
"1","  0.0184444"
"1","  0.1154228"
"1","   0.160"
"1","   0.8730"
"1","  "
"1","
Blood_Pressure_Systolic            "
"1","  0.0012301"
"1","  0.0059271"
"1","   0.208"
"1","   0.8356"
"1","  "
"1","
Blood_Pressure_Diastolic           "
"1","  0.0098574"
"1","  0.0112507"
"1","   0.876"
"1","   0.3809"
"1","  "
"1","
Blood_Pressure_Pulse               "
"1"," -0.0004297"
"1","  0.0133934"
"1","  -0.032"
"1","   0.9744"
"1","  "
"1","
Hemoglobin_Level                   "
"1"," -0.1091401"
"1","  0.0731037"
"1","  -1.493"
"1","   0.1355"
"1","  "
"1","
White_Blood_Cell_Count             "
"1"," -0.0158315"
"1","  0.0843035"
"1","  -0.188"
"1","   0.8510"
"1","  "
"1","
Platelet_Count                     "
"1"," -0.0014715"
"1","  0.0018405"
"1","  -0.800"
"1","   0.4240"
"1","  "
"1","
Albumin_Level                      "
"1"," -0.4806379"
"1","  0.2811017"
"1","  -1.710"
"1","   0.0873"
"1"," ."
"1","
Alkaline_Phosphatase_Level         "
"1"," -0.0013648"
"1","  0.0056681"
"1","  -0.241"
"1","   0.8097"
"1","  "
"1","
Alanine_Aminotransferase_Level     "
"1","  0.0004940"
"1","  0.0157764"
"1","   0.031"
"1","   0.9750"
"1","  "
"1","
Aspartate_Aminotransferase_Level   "
"1"," -0.0098345"
"1","  0.0139655"
"1","  -0.704"
"1","   0.4813"
"1","  "
"1","
Creatinine_Level                   "
"1"," -0.0222673"
"1","  0.5472891"
"1","  -0.041"
"1","   0.9675"
"1","  "
"1","
LDH_Level                          "
"1"," -0.0038008"
"1","  0.0034248"
"1","  -1.110"
"1","   0.2671"
"1","  "
"1","
Calcium_Level                      "
"1"," -0.0904136"
"1","  0.2207600"
"1","  -0.410"
"1","   0.6821"
"1","  "
"1","
Phosphorus_Level                   "
"1","  0.1902319"
"1","  0.2103890"
"1","   0.904"
"1","   0.3659"
"1","  "
"1","
Glucose_Level                      "
"1","  0.0044420"
"1","  0.0068219"
"1","   0.651"
"1","   0.5150"
"1","  "
"1","
Potassium_Level                    "
"1"," -0.0213339"
"1","  0.3631622"
"1","  -0.059"
"1","   0.9532"
"1","  "
"1","
Sodium_Level                       "
"1"," -0.0022242"
"1","  0.0530332"
"1","  -0.042"
"1","   0.9665"
"1","  "
"1","
Smoking_Pack_Years                 "
"1","  0.0039382"
"1","  0.0055548"
"1","   0.709"
"1","   0.4783"
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 334.06  on 240  degrees of freedom
"
"1",""
"1","Residual deviance: 292.28  on 195  degrees of freedom
"
"1","AIC: "
"1",""
"1","384.28"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","4"
"1",""
"1","
"
"1","
"
"0","# Perform backwards selection & select variables"
"0","step_model_for <- stepAIC(glm_full_model, "
"0","                          direction = ""both"","
"0","                          trace = FALSE)"
"0","selected_vars_for <- names(coef(step_model_for))[-1]"
"0","selected_vars_for"
"1","[1]"
"1"," ""Age""                              "
"1"," ""Family_HistoryYes""                "
"1","
"
"1","[3]"
"1"," ""Comorbidity_HypertensionYes""      "
"1"," ""Comorbidity_Autoimmune_DiseaseYes"""
"1","
"
"1","[5]"
"1"," ""Albumin_Level""                    "
"1","
"
"0","## develop a model only on those significant features"
"0","glm_feat_model <- glm(Stage ~ ., "
"0","                  data = trainData[,.SD,.SDcols=c(""Stage"", str_remove(selected_vars_for, ""Yes""))], "
"0","                  family = binomial)"
"0","# summary the model"
"0","summary(glm_feat_model)"
"1","
Call:
"
"1",""
"1","glm(formula = Stage ~ ., family = binomial, data = trainData[, 
    .SD, .SDcols = c(""Stage"", str_remove(selected_vars_for, ""Yes""))])"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                                 "
"1","  Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","  "
"1","
(Intercept)                      "
"1","  2.001990"
"1","   1.065652"
"1","   1.879"
"1","   0.0603"
"1"," ."
"1","
Age                              "
"1"," -0.014609"
"1","   0.009628"
"1","  -1.517"
"1","   0.1292"
"1","  "
"1","
Family_HistoryYes                "
"1"," -0.657256"
"1","   0.269805"
"1","  -2.436"
"1","   0.0148"
"1"," *"
"1","
Comorbidity_HypertensionYes      "
"1","  0.561085"
"1","   0.271451"
"1","   2.067"
"1","   0.0387"
"1"," *"
"1","
Comorbidity_Autoimmune_DiseaseYes"
"1","  0.430126"
"1","   0.272247"
"1","   1.580"
"1","   0.1141"
"1","  "
"1","
Albumin_Level                    "
"1"," -0.348745"
"1","   0.243277"
"1","  -1.434"
"1","   0.1517"
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 334.06  on 240  degrees of freedom
"
"1",""
"1","Residual deviance: 316.98  on 235  degrees of freedom
"
"1","AIC: "
"1",""
"1","328.98"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","4"
"1",""
"1","
"
"1","
"
"0","## test the model on test set"
"0","### confusion matrix and error"
"0","pred_class <- ifelse(predict(glm_full_model, testData,type = ""response"") >= 0.5, "
"0","                     ""High"", ""Low"")"
"0",""
"0","# confusion matrix on "
"0","table(pred_class, "
"0","      testData$Stage) %>% "
"0","  confusionMatrix(., positive  = ""High"")"
"1","Confusion Matrix and Statistics

"
"1","          
"
"1","pred_class"
"1"," High"
"1"," Low"
"1","
      High"
"1","   12"
"1","  17"
"1","
      Low "
"1","   18"
"1","  12"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.4068          "
"1","
"
"1","                 95% CI :"
"1"," (0.2807, 0.5425)"
"1","
"
"1","    No Information Rate :"
"1"," 0.5085          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 0.955           "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," -0.1861         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," 1.000           "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.4000          "
"1","
"
"1","            Specificity :"
"1"," 0.4138          "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.4138          "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.4000          "
"1","
"
"1","             Prevalence :"
"1"," 0.5085          "
"1","
"
"1","         Detection Rate :"
"1"," 0.2034          "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.4915          "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.4069          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," High            "
"1","
"
"1","                         "
"1","                 "
"1","
"
